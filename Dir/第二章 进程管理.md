# 第二章 进程管理

v  **本章内容：**进程的基本概念、进程控制、进程同步、经典进程的同步问题、进程通信、线程的基本概念

v  **主要考点：****★****程序和进程的区别、**进程的状态转化、原语、★**进程同步****S****值的变化和前趋图******

》》》管程、线程的概念



## 简述进程的定义

  （1）进程是程序的一次执行。

  （2）进程是一个程序及其数据在处理机上顺序执行时所发生的活动。

  （3）进程是程序在一个数据集合上的运行过程，它是系统进行资源分配和调度的一个独立单位。

  （4）进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位



## 说明进程与程序的区别

（1）程序是指令的有序集合，其本身没有任何运行的含义，它是一个静态的概念。而进程是程序在处理机上的一次执行过程，它是一个动态概念。

（2）程序的存在是永久的。而进程则是有生命期的，它因创建而产生，因调度而执行，因得不到资源而暂停，因撤消而消亡。

（3）程序仅是指令的有序集合。而进程则由程序段、相关数据段.进程控制块（PCB）组成。

（4）进程与程序之间不是一一对应。

（5）**并发性：**多个进程实体同存于内存中，且能在一段时间内同时运行。并发性是进程的重要特征，也是OS的重要特征。引入进程的目的也正是为了使其进程实体能和其它进程实体并发执行；而程序(没有建立PCB)是不能并发执行的。

（6）**独立性：**在传统的OS中，独立性是指进程实体是能独立分配资源和独立接受调度，能独立运行的基本单位。凡未建立PCB的程序都不能作为一个独立的单位参与运行。

（7）**异步性：**进程实体按异步方式运行,推进次序每次不一定相同。

## 进程实体

**程序段、相关数据、PCB（进程控制块）**三部分构成了进程实体。

##引起挂起状态的原因有

终端用户的请求、父进程的请求、负荷调节的需要、操作系统的需要。

## 原语(Primitive)

是由若干条指令组成的，用于完成一定功能的一个过程，原语在执行中不允许被中断，原语的作用是**实现进程的通信和控制。**常见的几种元语：**创建原语****create()**（功能：创建一新进程）、**阻塞原语****block()**（功能：将进程由执行状态转为阻塞状态）、**唤醒原语****wakeup()**（功能：将进程由阻塞状态变为就绪状态）、**挂起原语****suspend()**（功能：将指定进程或处于阻塞状态的进程挂起）、**激活原语****active()**（功能：将指定进程激活）。



## 同步机制应遵循的四条规则是

> **空闲让进、忙则等待、有限等待、让权等待。**



## 试写出相应的程序来描述下图所示的前驱图

![](http://oy3mfxixl.bkt.clouddn.com/201711271625_208.png)

```bash
Var a,b,c,d,e,f,g：semaphore: =0,0,0,0,0,0,0；
　　begin
　　　parbegin
　begin S1； signal(a)； signal(b)； end；
　begin wait(a)； S2； signal(c)； signal(d)； end；
　begin wait(b)； S3； signal(e)； end；
　begin wait(c)； S4； signal(f)； end；
　begin wait(d)； S5； signal(g)； end；
　begin wait(e)； wait(f)； wait(g)； S6； end；
　　　parend
　　end

```

## 管程的定义

一个管程定义了一个数据结构和能为并发进程所执行的一组操作，这组操作能同步进程和改变管程中的数据。

## 高级通信机制分为三大类

>**共享存储器系统、消息传递系统、管道通信系统**

## 操作系统中引入进程的目的是

> **为了使多个程序能并发执行，以提高资源利用率和系统吞吐量**
>
> 在操作系统中再引入线程，则是为了**减少程序在并发执行时所付出的时空开销。**

## 进程与线程的比较

![](http://oy3mfxixl.bkt.clouddn.com/201711271629_634.png)

## 试从调度性，并发性，拥有资源及系统开销方面对进程和线程进行比较

**调度性**：在传统的操作系统中，拥有资源的基本单位和独立调度、分派的基本单位都是进程，在引入线程的OS中，则把线程作为调度和分派的基本单位，而把进程作为资源拥有的基本单位；

**并发性：**在引入线程的OS中，不仅进程之间可以并发执行，而且在一个进程中的多个线程之间，亦可并发执行，因而使OS具有更好的并发性；

**拥有资源：**无论是传统的操作系统，还是引入了线程的操作系统，进程始终是拥有资源的一个基本单位，而线程除了拥有一点在运行时必不可少的资源外，本身基本不拥有系统资源，但它可以访问其隶属进程的资源；

**开销：**由于创建或撤销进程时，系统都要为之分配和回收资源，如内存空间等，进程切换时所要保存和设置的现场信息也要明显地多于线程，因此，操作系统在创建、撤消和切换进程时所付出的开销将显著地大于线程。

---



### 1.程序的顺序执行：

	(1)定义：把一个应用程序分成若干个程序段，在各程序段之间，必须按照某种先后次序顺序执行。
	(2)特征：顺序性，封闭性，可再现性。
### 2.程序的并发执行的特征：

	(1)间断性：程序在并发执行时，由于它们共享系统资源，以及完成同一项任务而相互合作，致使这些并发执行的程序之间，形成相互制约的关系。
	(2)失去封闭性：程序在并发执行时，各种资源由多个程序共享，因而这些资源的状态由多个程序来改变，致使程序的运行失去了封闭性。
	(3)不可再现性
### 3.进程：

	(1)定义：进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。
	(2)特征：
		结构特征：由程序段，数据段和进程控制块(PCB)构成进程实体。
		动态性：由创建而产生，由调度而执行，由撤销而消亡。
		并发性：指多个进程实体同存于内存中，且在一段时间内同时运行。
		独立性：指进程实体是一个能独立运行，独立分配资源，独立接受调度的基本单位。
		异步性：指进程按各自独立的，不可预知的速度向前推进，或说进程实体按异步方式运行。
### 4.进程的三种基本状态：

	(1)就绪(Ready)状态：当进程已分配到除CPU以外的所有必要资源后，只要再获得CPU，便可立即执行，进程这时的状态称为就绪状态。
	(2)执行状态：进程已获得CPU，其程序正在执行，此时称为执行状态。
	(3)阻塞状态：正在执行的进程由于发生某事件而暂时无法继续执行时，便放弃处理机而处于暂停状态，即进程的执行受到阻塞，这种暂停状态就称为阻塞状态。
### 5.挂起状态：

> (1)终端用户请求暂停时,正在执行的进程暂停执行，若进程处于就绪状态而未执行，则该进程暂不接受调度，此时这种静止状态称为挂起状态。
>
> (2)父进程请求。
>
> (3)负荷调节的需要。
>
> (4)操作系统的需要。

### 6.进程状态的转换：

	(1)活动就绪->静止就绪
		当进程处于未被挂起的就绪状态时，称为活动就绪状态(Readya)。当被挂起后，进程转变为静止就绪状态(Readys)，不再被调度执行。
	(2)活动阻塞(Blockeda)->静止阻塞(Blockeds)
	(3)静止就绪->活动就绪
		处于Readys，被激活后，转变为Readya状态
	(4)静止阻塞->活动阻塞
### 7.创建状态：

> 首先，为一个新进程创建PCB，填写必要管理信息；
>
> 其次，把该进程装入就绪状态并插入就绪队列之中。

### 8.终止状态：

> 首先等待操作系统进行善后处理，
>
> 然后将其PCB清零，并将PCB空间返还系统。

### 9.进程控制块(PCB)的作用：

> 记录操作系统所需的，用于描述进程的当前情况以及控制进程运行的全部信息。使一个在多道程序环境下不能独立运行的程序，称为一个能独立运行的基本单位，一个能与其他进程并发执行的进程。

### 10.PCB中的信息：

	(1)进程标识符：内部标识符，外部标识符。
	(2)处理机状态：由处理机的各种寄存器中的内容组成的。
	(3)进程调度信息：进程状态，进程优先级，进程调度所需的其他信息，事件。
	(4)进程控制信息：程序和数据的地址，进程同步和通信机制，资源清单，链接指针。
### 11.PCB的组织方式：

> (1)链接方式(2)索引方式

### 12.进程控制是进程管理中最基本的功能。

> 用于创建一个新进程，终止一个已完成的进程，或终止一个因出现某事件而使其无法运行下去的进程，还可负责进程运行中的状态转换。

### 13.子进程可以继承父进程所拥有的资源。

### 14.引起创建进程的事件：

> (1)用户登录。(2)作业调度。(3)提供服务。(4)应用请求。

### 15.引起进程终止的事件：

> (1)正常结束。(2)异常结束。(3)外界干预。

### 16.引起进程阻塞和唤醒的事件：

>(1)请求系统服务。(2)启动某种操作。(3)新数据尚未到达。(4)无新工作可做。

### 17.当程序并发执行时

> 由于资源共享和进程合作，使同处于一个系统中的诸进程之间可能存在着以下两种形式的制约关系：(1)间接相互制约关系。
>
> (2)直接相互制约关系。

### 18.同步机制应遵循的规则：

> (1)空闲让进。(2)忙则等待。(3)有限等待。(4)让权等待。

### 19.信号量机制：

> (1)整形信号量(2)记录型信号量(3)AND型信号量(4)信号量集

### 20.管程：

	(1)定义：一个管程定义了一个数据结构和能为并发进程执行的一组操作，这组操作能同步进程和改变管程中的数据。
	(2)特性：(1)模块化。(2)抽象数据类型。(3)信息掩蔽。
### 21.进程通信的类型：

	(1)共享存储器系统:基于共享数据结构的通信方式；基于共享存储区的通信方式。
	(2)消息传递系统
	(3)管道通信：指用于连接一个读进程和一个写进程以实现它们之间通信的一个共享文件，又名pipe文件。
### 22.消息传递通信的实现方法：

	(1)直接通信方式：指发送进程利用OS所提供的发送命令，直接把消息发送给目标进程。
	(2)间接通信方式：指进程之间的通信需要通过作为共享数据结构的实体。该实体用来暂存发送进程发送给目标进程的消息，接受进程则从该实体中取出对方发送给自己的消息。
### 23.线程的属性：

> (1)轻型实体。(2)独立调度和分派的基本单位。(3)可并发执行。(4)共享进程资源。

### 24.线程的状态参数：

> (1)寄存器状态(2)堆栈(3)线程运行状态(4)优先级(5)线程专有存储器(6)信号屏蔽